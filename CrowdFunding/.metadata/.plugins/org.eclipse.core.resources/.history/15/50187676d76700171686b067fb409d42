package com.redhat.crowdfunding.service;

import java.util.List;
import java.util.concurrent.ExecutionException;

import org.web3j.crypto.Credentials;

import com.redhat.crowdfunding.bean.Fund;
import com.redhat.crowdfunding.contract.CrowdFundingInterface;
import com.redhat.crowdfunding.util.Util;

/**
 * @author littleredhat
 */
public class CrowdFundingServiceImpl implements CrowdFundingService{

	private CrowdFundingInterface contract;
	
	public CrowdFundingServiceImpl(String contractAddress) {
		// 获得管理员凭证
		Credentials credentials = Util.GetCredentials();
		if (credentials == null) // 密码错误
			return;
		// 获取合约
		contract = Util.GetCrowdFundingContract(credentials, contractAddress);
	}
	
	/**
	 * 众筹列表
	 * @throws ExecutionException 
	 * @throws InterruptedException 
	 */
	public List<Fund> getFunds() throws InterruptedException, ExecutionException  {
		int count = contract.getFundCount().get().getValue().intValue();
		for(int i = 0 ; i < count ; i++) {
			String addr = contract.getFundAddr(i).get().getValue();
		}
		return null;
	}

	/**
	 * 发起众筹
	 */
	public boolean raiseFund(String owner) {
		// TODO Auto-generated method stub
		return false;
	}

	/**
	 * 发送金币
	 */
	public boolean sendCoin(int coin) {
		// TODO Auto-generated method stub
		return false;
	}
}
